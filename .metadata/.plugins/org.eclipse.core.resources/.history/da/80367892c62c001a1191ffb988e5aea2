package de.wfb.model.node;

import org.springframework.beans.factory.annotation.Autowired;

import de.wfb.model.service.IdService;
import de.wfb.rail.factory.Factory;
import de.wfb.rail.ui.ShapeType;

public class DefaultNodeFactory implements Factory<Node> {

	@Autowired
	private IdService idService;

	public Node create(final Object... args) {

		final int x = (Integer) args[0];
		final int y = (Integer) args[1];
		final ShapeType shapeType = (ShapeType) args[2];

		// if a shape type is selected, add a node
		final Node node = isTurnout(shapeType) ? new TurnoutNode() : new Node();
		node.setId(idService.getNextId());
		node.setX(x);
		node.setY(y);
		node.setShapeType(shapeType);

		return node;
	}

	private boolean isTurnout(final ShapeType shapeType) {

		switch (shapeType) {
		case SWITCH:
		case SWITCH_LEFT_0:
		case SWITCH_LEFT_90:
		case SWITCH_LEFT_180:
		case SWITCH_LEFT_270:
		case SWITCH_RIGHT_0:
		case SWITCH_RIGHT_90:
		case SWITCH_RIGHT_180:
		case SWITCH_RIGHT_270:
			return true;

		default:
			return false;
		}
	}

}
