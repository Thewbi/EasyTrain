package de.wfb.dialogs;

import java.io.FileNotFoundException;

import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.Logger;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.ApplicationEvent;
import org.springframework.context.ApplicationEventPublisher;
import org.springframework.context.ApplicationListener;

import de.wfb.model.node.Node;
import de.wfb.model.node.TurnoutNode;
import de.wfb.rail.events.NodeSelectedEvent;
import javafx.scene.control.TextField;
import javafx.scene.layout.GridPane;

public class SidePane extends GridPane implements ApplicationListener<ApplicationEvent> {

	private static final Logger logger = LogManager.getLogger(SidePane.class);

	/** https://www.baeldung.com/spring-events */
	@Autowired
	private ApplicationEventPublisher applicationEventPublisher;
	
	@Autowired
	private LayoutElementSelectionPane layoutElementSelectionPane;

	@Override
	public void onApplicationEvent(final ApplicationEvent event) {

		logger.info("onApplicationEvent " + event.getClass().getSimpleName());

		if (event instanceof NodeSelectedEvent) {

			final NodeSelectedEvent nodeSelectedEvent = (NodeSelectedEvent) event;

			final Node node = nodeSelectedEvent.getNode();

			logger.info(node);

			// textfield.setText(node.toString());

			setupNodeDetails(node);

		}
	}

	public void setup() throws FileNotFoundException {

		logger.info("setup()");

		setup();
		setupNodeDetails(null);
	}

	private void setupNodeDetails(final Node node) {

		logger.info("setupNodeDetails()");

		// getChildren()

		if (node == null) {
			return;
		}

		if (node instanceof TurnoutNode) {

			final TurnoutNode turnoutNode = (TurnoutNode) node;

			textfield = new TextField();
			textfield.setText("test");
			GridPane.setColumnIndex(textfield, 1);
			GridPane.setRowIndex(textfield, 3);

			getChildren().add(textfield);
		}
	}

}
